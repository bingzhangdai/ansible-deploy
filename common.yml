- hosts: all
  pre_tasks:
    - name: turn on the EPEL repo on CentOS/RHEL
      yum:
        name: epel-release
        state: present
      become: yes
      when: ansible_distribution == 'CentOS'
      tags: always
    - name: update repositories cache for Debian
      apt:
        update_cache: yes
        cache_valid_time: 86400
      become: yes
      when: ansible_os_family == 'Debian'
      tags: always
  roles:
    - { role: common, task: bash, tags: [bash] }
    - { role: common, task: fzf, tags: [fzf] }
    - { role: common, task: bat, tags: [bat] }
    - { role: common, task: fd, tags: [fd] }
    - { role: common, task: ripgrep, tags: [ripgrep] }
    - { role: common, task: vim, tags: [vim] }
    - { role: common, task: ssh, tags: [ssh] }
    - { role: common, task: git, tags: [git] }
    - { role: common, task: misc, packages: "{{ misc_packages | default([]) | unique }}", tags: [misc] }
  tags:
    - common
